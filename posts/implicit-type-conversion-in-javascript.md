---
title: JavaScript ä¸­çš„éšå¼ç±»å‹è½¬æ¢çš„è§„èŒƒ
date: 2018-04-02 10:29:09
tags: [å‰ç«¯]
---

æœ¬æ–‡ä» ECMAScript è§„èŒƒçš„è§’åº¦å°è¯•å¾æœ JavaScript çš„çœŸå€¼è¡¨ï¼å…¨æ–‡éƒ½æ˜¯è§„èŒƒï¼Œä¸è¦æ–¹ï¼Œæ­£é¢åˆšï¼

<!-- more -->

## å°è¯•ç‰›åˆ€

å¦‚æœä½ èƒ½æŠŠä¸‹é¢çš„æ‰€æœ‰é¢˜ç›®éƒ½ç­”å¯¹å¹¶è§£é‡Šæ¸…æ¥šæ¥é¾™å»è„‰ï¼Œæ­å–œä½ ï¼Œä½ å·²ç»æ˜¯å¤§ç¥çº§åˆ«äº†ï¼ç­”æ¡ˆå°±è¯·è‡ªè¡Œæ‰¾ä¸ª Console å®é™…æ•²æ•²ï¼ŒBelieve meï¼Œä½ ä¼šå¤§åƒä¸€æ–¤çš„ã€‚

```js
// æ¯ä¸ªè¡¨è¾¾å¼æ˜¯ true è¿˜æ˜¯ false å‘¢ï¼Ÿä¸ºå•¥å‘¢ï¼Ÿ

// åˆé˜¶
!{}
12 == '12'
'false' == false
null == undefined

// é«˜é˜¶
[] == []
[] == false
[] === false
[45] == 45

// ç»ˆé˜¶
[45] < [46]
[10] < [9]
{} == !{}
{} != {}
-0 === +0
NaN === NaN
NaN != NaN
```

## æ·±å…¥è§„èŒƒ

æ±Ÿæ¹–ä¼ é—» JavaScript æœ‰å¼ è®©äººé—»é£ä¸§èƒ†çš„**çœŸå€¼è¡¨**ï¼Œæˆ‘è§‰å¾—å§åªè¦æŠŠæ¯ç§ç±»å‹æ˜¯æ€ä¹ˆåˆ¤æ–­çš„å¼„æ¸…æ¥šï¼Œå…¶å®æ˜¯ä¸éœ€è¦å»è®°å¿†è¿™æ ·çš„è¡¨çš„ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦äº†è§£è§„èŒƒé‡Œæ˜¯æ€ä¹ˆå¤„ç†è¿™äº›è¡¨è¾¾å¼çš„ã€‚

è§„èŒƒä¸­å…³äºä¸Šé¢é‚£å †è¡¨è¾¾å¼æ˜¯æ€æ ·æ±‚å€¼çš„æœ‰å¥½å‡ å¤„åœ°æ–¹çš„è¯´æ˜ï¼ŒåŒ…æ‹¬

- [7.1 Type Conversion](http://www.ecma-international.org/ecma-262/8.0/index.html#sec-type-conversion)
- [7.2 Testing and Comparison Operations](http://www.ecma-international.org/ecma-262/8.0/index.html#sec-testing-and-comparison-operations)
- [12.5.9 Logical NOT Operator ( `!` )](http://www.ecma-international.org/ecma-262/8.0/index.html#sec-logical-not-operator)
- [12.10 Relational Operators](http://www.ecma-international.org/ecma-262/8.0/index.html#sec-relational-operators) 

### Type Conversion

#### Built-in Types

è¿™éƒ¨åˆ†è§„å®šäº†ä¸åŒ Type ä¹‹é—´è½¬æ¢æ—¶ï¼Œåº”è¯¥å¦‚ä½•è¿›è¡Œè½¬æ¢ã€‚åœ¨æ­¤ä¹‹å‰éœ€è¦äº†è§£ ECMAScript åˆ°åº•å®šä¹‰äº†å¤šå°‘ç§ Typeï¼Ÿ

ECMAScript ä¸€å…±å®šä¹‰äº†ä¸ƒç§ built-in typesï¼Œå› æ­¤åœ¨èŠ‚ [6.1 ECMAScript Language Types](http://www.ecma-international.org/ecma-262/8.0/index.html#sec-ecmascript-language-types) å…±æœ‰ä¸ƒä¸ªå°èŠ‚ï¼Œåˆ†åˆ«è¯¦ç»†è§£é‡Šä¸ƒç§ç±»å‹ã€‚ å…¶ä¸­å…­ç§ç±»å‹ä¸º **Primitive Value**.ï¼ˆä½™æ–‡æ‰€æœ‰åŠ ç²—çš„ç±»å‹å‡è¡¨ç¤º ECMAScript Language Typeï¼Œæ²¡æœ‰åŠ ç²—è¡¨ç¤º JavaScript ä¸­çš„ç±»å‹ï¼‰

> A primitive value is a member of one of the following built-in types: **Undefined**, **Null**, **Boolean**, **Number**, **String**, and **Symbol;** an object is a member of the built-in type **Object**; and a function is a callable object.

æƒ³å»äº†è§£è¯¦æƒ…çš„å¯ä»¥å»çœ‹çœ‹è§„èŒƒï¼Œé‡Œé¢å…³äº Number ç±»å‹çš„è§£é‡Šä¼šè®©äººè±ç„¶å¼€æœ—çš„ã€‚è¿™é‡Œåªéœ€è¦çŸ¥é“ `null` è¿™ä¸ªå€¼æ˜¯å±äº **Null** ç±»å‹ï¼Œè€Œ `undefined` æ˜¯å±äº **Undefined** ç±»å‹çš„ã€‚

å¦å¤–è¿™é‡Œçš„ **Object** built-in type è·Ÿæˆ‘ä»¬å¹³å¸¸ç†è§£çš„ JavaScript é‡Œçš„ `Object` å¹¶ä¸ä¸€æ ·ï¼Œæ€»çš„æ¥è¯´åªè¦ä¸å±äº Primitive Value çš„å€¼ï¼Œå°±å±äº **Object** ç±»å‹ã€‚æ¯”å¦‚å¼€å‘ä¸­å¸¸è§çš„æ•°ç»„ã€å¯¹è±¡ã€`Date`ã€`RegExp` ç­‰åœ¨ ECMAScript ä¸­å‡å±äº **Object** ç±»å‹ã€‚

#### ToPrimitive

**ToPrimitive** ç”¨äºå°† **Object** è½¬ä¸º **Primitive Value**

å…ˆå¿½ç•¥é‚£å † `preferredType` çš„ä¸œè¥¿ï¼Œå¯¹äºå¹³å¸¸é‡åˆ°çš„å¯¹è±¡ï¼ˆObjectï¼‰æ¥è¯´ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯ Ordinary çš„ï¼Œæ‰€ä»¥å…¶å®å°±æ˜¯é»˜è®¤äº† `hint = number` å†å»è°ƒç”¨ `OrdinaryToPrimitive`ã€‚

ç”±äºè¿›æ¥çš„ `hint` æ˜¯ `number` æ‰€ä»¥è¿™ä¸ªè½¬æ¢å°±æ˜¯ï¼š

- è°ƒç”¨ `Object.valueOf`ï¼Œå¦‚æœç»“æœæ˜¯ **Primitive Value**ï¼Œåˆ™è¿”å›
- è°ƒç”¨ `Object.toString`ï¼Œå¦‚æœç»“æœæ˜¯ **Primitive Value**ï¼Œåˆ™è¿”å›
- éƒ½ä¸æ˜¯ï¼Œè¿”å› TypeError

å¦‚æœçœ‹è¿‡çº¢å®ä¹¦çš„è¯ï¼Œé‡Œé¢å…¶å®ä¹Ÿè®²åˆ°è¿™éƒ¨åˆ†å†…å®¹ï¼Œè¿™é‡Œå¯ä»¥ä»è§„èŒƒçš„è§’åº¦å†ä¸€æ¬¡è¯´æ˜ã€‚

ç„¶åæ¥çœ‹çœ‹æ™®é€šå¯¹è±¡å’Œæ•°ç»„çš„è¿™ä¸¤ä¸ªæ–¹æ³•è¿”å›çš„æ˜¯ä»€ä¹ˆã€‚

```javascript
var a = [12]
var b = {a: 123}

// [12]
a.valueOf()

// '12'
a.toString()

// {a: 123}
b.valueOf()

// '[object Object]'
b.toString()
```

å¯ä»¥çœ‹åˆ°ä¸¤è€…çš„ `valueOf` è¿”å›çš„**éƒ½ä¸æ˜¯ Primitive Value**ï¼ˆè¿”å›äº†è‡ªèº«ï¼Œè¿˜æ˜¯å±äº **Object** ç±»å‹ï¼‰ï¼Œæ ¹æ®è§„èŒƒä¸¤è€…è°ƒç”¨ **ToPrimitive** è¿”å›çš„å°†æ˜¯ä¸€ä¸ª**å­—ç¬¦ä¸²**ï¼Œè¿™ä¸€ç‚¹éå¸¸é‡è¦ã€‚

#### ToBoolean

è¿™ä¸ªæ–¹æ³•ç”¨äºå°†ä¸æ˜¯ **Boolean** ç±»å‹çš„å€¼è½¬æ¢ä¸º **Boolean** ç±»å‹ã€‚

æ³¨æ„å‡ ç‚¹å°±å¯ä»¥äº†ï¼š

- æ‰€æœ‰ **Object** ç±»å‹éƒ½ä¼šè¢«è½¬æ¢ä¸º true
- **Number** ç±»å‹ä¸­çš„ 0ã€NaN ä¼šè¢«è½¬æ¢ä¸º falseï¼Œå…¶ä»–éƒ½æ˜¯ true
- åªæœ‰ç©ºä¸²æ‰ä¸º falseï¼Œå…¶ä»–éƒ½æ˜¯ trueï¼ˆ`'false'`/`'0'` ä¹‹ç±»çš„ä¸è¦æé”™ï¼‰

#### ToNumber

åŒç†ï¼Œå…¶ä»–ç±»å‹è½¬æ¢ä¸º **Number** ç±»å‹ã€‚

æœ‰æ¯”è¾ƒè¯¡å¼‚çš„å‡ ç‚¹ï¼š

- `undefined` ä¼šè¢«è½¬ä¸º NaNï¼›è€Œ `null` æ˜¯è½¬ä¸º +0
- `true` è½¬ä¸º 1ï¼›`false` è½¬ä¸º +0ï¼ˆè¿™ä¸ªå¾ˆé‡è¦ï¼‰
- **String** çš„è½¬æ¢ç­–ç•¥ä¸æ˜¯æœ¬æ–‡çš„é‡ç‚¹ï¼Œå¯ä»¥å…ˆç†è§£ä¸ºæ»¡è¶³æ•°å­—è¯­ä¹‰ï¼ˆå³è§„èŒƒä¸‹æ–‡çš„ *StringNumericLiteral*ï¼‰çš„å°±è½¬æ¢æˆæ•°å­—ï¼Œä¸ç¬¦åˆå°±æ˜¯ NaN
- **Object** ç±»å‹çš„è½¬æ¢ï¼Œçœ‹åˆ°äº†æˆ‘ä»¬çš„è€æœ‹å‹ **ToPrimitive** äº†æ²¡ï¼Ÿå…ˆè½¬æˆ **Primitive Value**ï¼Œå†é€’å½’è°ƒç”¨è‡ªèº« **ToNumber** æ¥åšè½¬æ¢çš„

åˆ°äº†è¿™ä¸€æ­¥ï¼Œçœ‹çœ‹æ˜¯å¦ç†è§£äº†ï¼Ÿ

```javascript
// '56' ==> 56
Number([56])

// ',56' ==> NaN
Number([,56])

// '55,56' ==> NaN
Number([55, 56])
```

è¿™é‡Œçš„è½¬æ¢æ˜¯åˆ†ä¸¤æ­¥çš„ï¼Œ**å…ˆ**è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œ**å†**è½¬æ¢æˆæ•°å­—ï¼Œè¿™ä¸ªå¾ˆé‡è¦ã€‚

### Logical NOT Operator

äº†è§£å®Œä¸Šé¢å‡ ä¸ªè½¬æ¢åå°±å¯ä»¥æ¥çœ‹é‚£ä¸€å †è¡¨è¾¾å¼äº†ï¼é¦–å…ˆæ˜¯ç®€å•ç‚¹çš„å•ç›®é€»è¾‘éï¼Œè§„èŒƒæ˜¯è¿™æ ·çš„ï¼š

å“‡å“¦ï¼Œå°±æ˜¯ç›´æ¥è°ƒç”¨äº† **ToBoolean**ï¼Œç„¶åå–åè¿”å›ã€‚

```javascript
// [] ==> true; false
![] 

// {} ==> true; false
!{}

// NaN ==> false; true
!NaN
```

å—¯ï¼Œåº”è¯¥æ²¡ä»€ä¹ˆå¤§é—®é¢˜ã€‚

### Comparison Operations

å¤§ boss æ¥äº†ï¼Œæœ‰ä¸å°‘æ–‡ç« éƒ½æœ‰ä»‹ç» `==` å’Œ `===` çš„å¼‚åŒï¼Œç›´æ¥çœ‹è§„èŒƒä¾ç„¶æ˜¯æœ€å¥½çš„ã€‚

#### Evaluation

`GetValue` å°±æ˜¯è®¡ç®—ä¸€ä¸‹è¡¨è¾¾å¼çš„å€¼ï¼Œ`==` å’Œ `===` çš„ç»“æœé‡ç‚¹åœ¨ **Abstract Equality Comparison** å’Œ **Strict Equality Comparison** è¿™ä¸¤ä¸ªæ“ä½œé‡Œã€‚

å¦å¤– `!=` å’Œ `!==` åˆ™æ˜¯æŒ‡å‡ºäº† `A != B` ä¸ `!(A == B)` æ˜¯**å®Œå…¨ç­‰ä»·**çš„ã€‚åœ¨åˆ¤æ–­ `!=`/`!==` æ—¶ï¼Œå…¶å®å°±æ˜¯åœ¨åˆ¤æ–­ `==`/`===`.

#### Abstract Equality Comparison

å¥½é•¿å•Šï¼Œä¸è¦æ…Œï¼Œä¸­æ–‡ç¿»è¯‘ä¸€ä¸‹ï¼š

- å¦‚æœ **Type** ç›¸åŒï¼Œç­‰ä»·ä¸º `A === B`
- ç‰¹åˆ«åœ°ï¼Œ`undefined == null`
- **String** == **Number**ï¼Œåˆ™æŠŠ **String** è½¬æ¢æˆ **Number**
- æœ‰ **Boolean** å€¼çš„ï¼Œå°† **Boolean** è½¬æ¢æˆ **Number**
- **Object** == **String/Number/Symbol**ï¼Œå°† **Object** è½¬æ¢æˆ **Primitive Value**
- å¦åˆ™ï¼Œè¿”å› false

ç»“åˆå°è¯•ç‰›åˆ€çš„ä¾‹å­æ¥è¯´æ˜

```javascript
// '12' ==> 12; 
// è¿”å› true
12 == '12'

// è½¬ boolean: [] == 0
// è½¬ object: '' == 0
// è½¬ string: 0 == 0
// è¿”å› true
[] == false

// è½¬ object: '45' == 45
// è½¬ string: 45 == 45
// è¿”å› true
[45] == 45

// å•ç›®: {} == false
// è½¬ boolean: {} == 0
// è½¬ object: '[object Object]' == 0
// è½¬ string: NaN == 0
// è¿”å› false
{} == !{}
```

å¯èƒ½æœ‰éƒ¨åˆ†åŒå­¦å¯¹äº `[] == false` çš„è½¬æ¢è¿‡ç¨‹ä¸­å±…ç„¶ä¼šå‡ºç° `'' == 0` è¿™ä¸€æ­¥æ„Ÿåˆ°è¯§å¼‚ï¼Œå•Šï¼ç©ºæ•°ç»„ä¸æ˜¯ç›´æ¥å°±è½¬æˆæ•°å­— 0 çš„å—ï¼Œç„¶åè·Ÿ 0 æ¯”è¾ƒçš„å—ï¼Ÿ

åŒæ ·ä½¿äººå›°æƒ‘çš„è¿˜æœ‰ `0 == {}` è¿™ä¸ªè½¬æ¢è¿‡ç¨‹ä¸­ä¼šå‡ºç°çš„ `'[object Object]'` ï¼ŒåŸå› æ˜¯ï¼Œæœ€åå°† **Object** è½¬æ¢ä¸º **Primitive Value** è°ƒç”¨çš„ **ToPrimitive**ï¼Œåœ¨å‰æ–‡å·²ç»æåˆ°ï¼Œå¯¹äºæ•°ç»„å’Œæ™®é€šå¯¹è±¡è€Œè¨€ï¼Œè½¬æ¢å‡ºæ¥çš„æ˜¯ Stringï¼Œè€Œä¸æ˜¯ Numberã€‚ä¸ºäº†è¯æ˜è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°è¯•æ”¹å†™ Object æˆ– Array ä¸Šçš„ valueOf æ–¹æ³•å’Œ toString æ–¹æ³•ã€‚

```javascript
console.log([] == false)

Array.prototype.toString = function () {
  return '1'
}

console.log([] == false)
console.log([] == 1)
```

å¯ä»¥çœ‹åˆ°ä¸¤æ¬¡çš„è¾“å‡ºæ˜¯ä¸ä¸€æ ·çš„ï¼Œè¦†ç›–äº†é»˜è®¤çš„ `toString` æ–¹æ³•åï¼Œ`[] == 1` è¾“å‡ºäº† `true`ï¼Œå› ä¸ºæ­¤æ—¶æ•°ç»„çš„ **ToPrimitive** æ–¹æ³•è¿”å›çš„æ˜¯å­—ç¬¦ä¸² `'1'`ï¼ŒåŒç† Object çš„æƒ…å†µä¹Ÿæ˜¯å¦‚æ­¤ã€‚ï¼ˆé¡ºä¾¿å¯ä»¥éªŒè¯ `valueOf` ç¡®å®æ˜¯ä¼˜å…ˆäº `toString` æ–¹æ³•çš„ï¼‰

```javascript
console.log('[object Object]' == {})

Object.prototype.toString = function () {
  return '1'
}

Object.prototype.valueOf = function () {
  return '2'
}

console.log('[object Object]' == {})
console.log(1 == {})
console.log(2 == {})
```

#### Strict Equality Comparison

- ç±»å‹ä¸åŒï¼Œç›´æ¥è¿”å› false
- **Number** ç±»å‹åˆ¤æ–­ï¼šæœ‰ NaN å°± falseï¼›+0 === -0ï¼›
- æœ€åè°ƒç”¨ **SameValueNonNumber**

æ€»çš„æ¥è¯´ï¼Œä¸¥æ ¼ç›¸ç­‰æ²¡æœ‰éä¸¥æ ¼ç›¸ç­‰è¿™ä¹ˆå¤šæƒ…å†µè·Ÿè½¬æ¢ï¼ˆæ¯•ç«Ÿå°±æ˜¯åŒä¸€ç±»å‹äº†ï¼‰ï¼Œè®°ä½äº† NaN çš„ corner case å’Œå¯¹è±¡å¼•ç”¨æœ¬èº«ç›¸ç­‰æ‰æ˜¯ true å°± ok äº†ã€‚

```javascript
// ç±»å‹ç›¸åŒï¼Œç­‰ä»·äº [] === []
// è¿”å› false
[] == []

// ç­‰ä»·äº !({} == {})
// ç­‰ä»·äº !({} === {})
// è¿”å› true
{} != {}

// ç­‰ä»·äº !(NaN == NaN)
// ç­‰ä»·äº !(NaN === NaN)
// è¿”å› true
NaN != NaN

// ç±»å‹ä¸åŒï¼Œè¿”å› false
[] === false
```

### Relational Operators

ææ‚äº†ç›¸ç­‰ï¼Œä¸ç­‰æ€ä¹ˆåŠï¼Ÿä¸ç­‰å…³ç³»æ˜¯ç”± **Abstract Relational Comparison** å®šä¹‰çš„ã€‚

è¿™ä¸ªæ˜¯çœŸçš„é•¿ï¼Œå…¶å®æ³¨æ„ä¸¤ç‚¹å°±å¯ä»¥äº†

- ä¸¤è¾¹æ“ä½œæ•°è°ƒç”¨ **ToPrimitive** è½¬æ¢ä¸º **Primitive Value**
- ç”±äº **Primitive Value** å‡ºæ¥æœ‰ **String** å’Œ **Number** ä¸¤ç§ç»“æœï¼Œåˆ†åˆ«æœ‰ä¸åŒçš„æ¯”è¾ƒè§„åˆ™ï¼›String æŒ‰ code unit æ¯”è¾ƒï¼ŒNumber éœ€è¦å¤„ç† +0/-0/NaN/Infinity ç­‰æƒ…å†µ

è§£é‡Šä¸‹ä¸Šé¢çš„é¢˜ç›®

```javascript
// æ³¨æ„è½¬æ¢åä¸º '45' < '46'
// æŒ‰å­—ç¬¦ä¸²è§„åˆ™æ¯”è¾ƒï¼Œè¿”å› true
[45] < [46]

// åŒç† '10' < '9'ï¼Œåˆ™æ˜¯è¿”å› false
[10] < [9]
```

## æŒ‡å¯¼æ„ä¹‰

äº†è§£è¿™äº›å¯¹å®é™…å¼€å‘å·¥ä½œæœ‰ä»€ä¹ˆç°å®æ„ä¹‰å—ï¼Ÿé¢ï¼Œå¾ˆå¯èƒ½æ˜¯æ²¡æœ‰çš„ï¼Œå¤§å¤šéƒ½æ˜¯å„ç§é¢è¯•é¢˜ï¼ˆç¬‘ã€‚

ä½†äº†è§£èƒŒåçš„åŸç†å¯¹äºä¸€äº›å…³äºç±»å‹è½¬æ¢å¸¦æ¥çš„ Bug çš„å®šä½å’Œå¦‚ä½•å»åšå®é™…ç¼–ç ä¸­çš„æœ€ä½³å®è·µèƒ½æä¾›å¾ˆå¤§çš„å¸®åŠ©ã€‚ä¸¾ä¸¤ä¸ªğŸŒ°

åˆå§‹åŒ–è®¢å•å§ã€‚

```javascript
if (!$scope.orders) {
  $http.post('/api/orders', $scope.params).then(res => {
    $scope.orders = res.data
  })
}
```

ç„¶è€Œæœ‰äººå¾ˆæœ‰è´£ä»»æ„Ÿåœ°è¿›è¡Œäº†æ•°æ®åˆå§‹åŒ–ï¼š`$scope.orders = []`ï¼ŒGGï¼

ç”¨æˆ·æ²¡æœ‰é€‰æ‹©çŠ¶æ€å°±å¼¹å‡ºæç¤ºã€‚

```javascript
if (!this.editForm.status) {
  this.warning('è¯·é€‰æ‹©çŠ¶æ€')
}
```

è¿™ä¸ä¼šæ˜¯ä¸ªæ•°ç»„äº†å§ï¼Œå¾ˆä¸å¹¸ï¼Œåç«¯åŒå­¦å®šä¹‰çš„ `status` é‡Œæœ‰ä¸ª 0...æœ‰ä¸ª 0..æœ‰ä¸ª 0.

## å‚è€ƒ

- [ECMAScriptÂ® 2017 Language Specification (ECMA-262, 8th edition, June 2017)](http://www.ecma-international.org/ecma-262/8.0/index.html)
- [èŠèŠç±»å‹è½¬æ¢](https://ppt.baomitu.com/d/e6515023#/)
